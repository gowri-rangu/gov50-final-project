---
title: "Gov 50 Final Project"
author: "Gowri Rangu"
description: "Does gender and ethnicity play a role in the perceptions of personal safety and experiences with harassment?"
output:
  distill::distill_article:
    self_contained: false
---

```{r echo = FALSE}
library(tidyverse)
library(infer)
```

```{r echo = FALSE}
```

Project Proposal: Does gender and ethnicity play a role in the perceptions of personal safety and experiences with harassment? In this study, I plan to examine the possible disparities in perception of personal safety and experiences with harassment amongst genders and ethnicities. I hypothesize that women and people of color have a lower sense of personal safety and more experiences with harassment as these groups have been historically marginalized and discriminated against in society. My sample consists of over 6,000 survey male and female participants of various ethnicities - White, Asian, Black, and mixed. My unit of analysis is each respondent in the study. The explanatory variable of interest is whether or not the participant is a male or woman. Another explanatory variable is whether or not the participant is a person of color. The variable is coded =1 for female and =0 for male. My outcome variable is the percentage of respondents that feel “Very safe,” “Fairly safe,” “Fairly unsafe,” or “Very Unsafe” when he/she is walking in public at night dark alone. If I observe that more women and people of color respond in higher numbers that they feel fairly or very unsafe walking alone in the dark than those of men and White people, this would provide support for my hypothesis. On the other hand, if I observe that women and people of color respond in lower or similar numbers to the same issue than those of men and White people, this would provide evidence against my hypothesis. When I run my regression of the percentage rates of each demographic group for perceptions of feeling unsafe on the gender and ethnicity variable indicator variables, a positive, significant coefficient would indicate support for my hypothesis.

```{r echo = FALSE}
voters |>
  group_by(gender) |>
  count(voter_category) |>
  ggplot(aes(x = gender, y = n, fill = voter_category)) +
  geom_col(position = "dodge") +
  labs(x = "Gender", 
       y = "Count",
       fill = "Voter Category",
       title = "Distribution of Voter Categories by Gender")
```


```{r echo = FALSE}
set.seed(02138)
ate <- voters |>
  specify(weight ~ gender) |>
  calculate(stat = "diff in means", order = c("Male", "Female"))

null_dist <- voters |>
  specify(weight ~ gender) |>
  hypothesise(null = "independence") |>
  generate(reps = 1000, type = "permute") |>
  calculate(stat = "diff in means", order = c("Male", "Female"))

p_val <- voters |>
  get_p_value(obs_stat = ate, direction = "both")
p_val

null_dist |>
  visualise() +
  shade_p_value(obs_stat = p_val, direction = "both")
```





```{r echo = FALSE}
voters |>
  count(race)
```

```{r echo = FALSE}
ate_gender <- voters |>
  rep_slice_sample(prop = 1, replace = TRUE, reps = 1000) |>
  group_by(replicate, gender) |>
  summarise(weight_mean = mean(weight)) |>
  pivot_wider(names_from = gender, 
              values_from = weight_mean) |>
  mutate(ate = `Male` - `Female`) |>
  select(ate)

ate_gender

ate_ci <- ate_gender |>
  get_confidence_interval(level = 0.95, type = "percentile")

ate_ci

ggplot(ate_gender, aes(x = ate)) + 
  geom_histogram(aes(y = ..density..)) +
  geom_vline(xintercept = unlist(ate_ci)) +
  labs(x = "Average Treatment Effect between Men and Women in Voting Weight",
       y = "Density")
```

Since the confidence interval of the ATE, which runs approximately from -0.149 to -0.116, does not contain the value zero, there is significant difference in the ATE of Voting Weight between Men and Women. 

