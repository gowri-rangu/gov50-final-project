---
title: "Gov 50 Final Project"
author: "Gowri Rangu"
description: "Did private defense funding and party identification influence the House of Representatives' 2013 vote to continue the National Security Agency's (NSA's) mass surveillance of phone behaviors?"
output:
  distill::distill_article:
    self_contained: false
---

```{r echo = FALSE}
library(tidyverse)
library(infer)
library(kableExtra)


votes <- read_csv("vote_nsa.csv") |>
  mutate(position = ifelse(phone_spy_vote == "continue_allowing_mass_surveillance", 1, 0),
         party_bi = ifelse(party == "R", 1, 0),
         money_thous = money/1000) |>
  drop_na(phone_spy_vote)

votes |>
  count(position)
```

```{r echo = FALSE}
votes |>
  ggplot(aes(x = money_thous, fill = as.factor(position))) + 
  geom_histogram(aes(y = ..count../sum(..count..)), position = "stack", col = "white") + 
  labs(x = "Funding Recieved (in thousands)",
       y = "Proportion of Voting Stances",
       fill = "Vote")  +
  scale_fill_manual(values = c("red2", "forestgreen"))
```

Distribution of votes by party
```{r echo = FALSE}
votes |>
  filter(position == 1)|>
  ggplot(aes(x = position, fill = as.factor(party))) + 
  geom_histogram(aes(y = ..count../sum(..count..)), party = "stack", col = "white") +
  labs(
    title = "Distribution of Votes in Support of NSA Amendment by Party",
    x = "v", 
    y = "Proportion of Votes for Mass Surveillance", 
    fill = "Party"
  ) + scale_x_discrete(labels=c("continue_allowing_mass_surveillance" = "")) +
  scale_fill_manual(values = c("steelblue1", "indianred1"))
```

Multivariate Regression: Vote in relation to party and money
```{r echo = FALSE}


fit <- lm(position ~ party + money_thous, data = votes) 

tab <- summary(fit)$coefficients

row.names(tab) <- c("Intercept", "Party", "Defense Funding (in thousands)")
colnames(tab) <- c("Estimate", "Std. Error", "t-value", "p-value")

kbl(tab, digits = 3) |>
  kable_styling(bootstrap_options = "striped", font_size = 12, full_width = F)

```




