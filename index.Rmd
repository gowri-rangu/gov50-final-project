---
title: "Gov 50 Final Project"
author: "Gowri Rangu"
description: "Do gender, race, income level, education, and/or age influence a person's voting habits (always, sporadic, rarely/never)?"
output:
  distill::distill_article:
    self_contained: false
---

```{r echo = FALSE}
library(tidyverse)
library(infer)
voters <- read_csv("voters.csv")
```


```{r echo = FALSE}
voters |>
  group_by(gender) |>
  count(voter_category) |>
  ggplot(aes(x = gender, y = n, fill = voter_category)) +
  geom_col(position = "dodge") +
  labs(x = "Gender", 
       y = "Count",
       fill = "Voter Category",
       title = "Distribution of Voter Categories by Gender")
```


```{r echo = FALSE}
set.seed(02138)
ate <- voters |>
  specify(weight ~ gender) |>
  calculate(stat = "diff in means", order = c("Male", "Female"))

null_dist <- voters |>
  specify(weight ~ gender) |>
  hypothesise(null = "independence") |>
  generate(reps = 1000, type = "permute") |>
  calculate(stat = "diff in means", order = c("Male", "Female"))

p_val <- voters |>
  get_p_value(obs_stat = ate, direction = "both")

null_dist |>
  visualise() +
  shade_p_value(obs_stat = p_val, direction = "both")
```


```{r echo = FALSE}
ate_gender <- voters |>
  rep_slice_sample(prop = 1, replace = TRUE, reps = 1000) |>
  group_by(replicate, gender) |>
  summarise(weight_mean = mean(weight)) |>
  pivot_wider(names_from = gender, 
              values_from = weight_mean) |>
  mutate(ate = `Male` - `Female`) |>
  select(ate)

ate_ci <- ate_gender |>
  get_confidence_interval(level = 0.95, type = "percentile")


ggplot(ate_gender, aes(x = ate)) + 
  geom_histogram(aes(y = ..density..)) +
  geom_vline(xintercept = unlist(ate_ci)) +
  labs(x = "Average Treatment Effect between Men and Women in Voting Weight",
       y = "Density")
```

Since the confidence interval of the ATE, which runs approximately from -0.149 to -0.116, does not contain the value zero, there is significant difference in the ATE of Voting Weight between Men and Women. 

